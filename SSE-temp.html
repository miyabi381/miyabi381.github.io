<!DOCTYPE html>
<html lang="ja">

<head>
	<title>
		SSE用一時保存
	</title>
	<link rel="stylesheet" href="css/style.css">
	<script type="text/javascript" src="js/main.js"></script>
</head>

<body>
	<div class="wide">
		<div class="page-top up op">
			<a href="#"><img src="image/top_page.png" alt="topPageLink"></a>
		</div>
		<header>
			<h1 class="logo"><a href="index.html"><img src="image/logo.png" alt="miyabi free and easy"></a></h1>
			<nav class="nav">
				<ul>
					<li><a href="index.html">ホーム</a></li>
					<li><a href="about.html">自己紹介</a></li>
					<li class="selectdiv">
						<select onChange="location.href=value;">
							<option selected>ARK:設定</option>
							<option value="ark_cocacola.html">こかこーら！</option>
							<option value="ark_shioripi.html">しおりぴのもり</option>
						</select>
					</li>

					<li><a href="valheim.html">Vlaheim:Mod設定</a></li>
					<li><a href="phasmophobia.html">Phasmophobia:証拠シミュレーション</a></li>
					<li><a href="SSE-temp.html">SSE</a></li>
					<li><a href="Scheduler-test.html">スケジューラ-テスト</a></li>
				</ul>
			</nav>
		</header>

		<h2>SSE用一時保存</h2>
		<table frame="box" class="mokuji">
			<tr>
				<td style="width: 700px;"></td>
			</tr>
			<tr high="20px">
				<td colspan="3">
					<h3 class="nospace">■ manifest.json</h3>
				</td>
			</tr>
			<tr>
				<td>
					<pre class="boxShadow">
{
  "manifest_version": 3,
  "name": "スケジューラ　グループ選択ボタン",
  "version": "0.1",
  "permissions": [
    "scripting",
    "tabs"
  ],
  "host_permissions": [
    "<all_urls>"
  ],
  "background": {
    "service_worker": "background.js"
  }
}

    
						</pre>
				</td>
			</tr>
		</table>

		<table frame="box" class="mokuji">
			<tr>
				<td style="width: 700px;"></td>
			</tr>
			<tr high="20px">
				<td colspan="3">
					<h3 class="nospace">■ background.js</h3>
				</td>
			</tr>
			<tr>
				<td>
					<pre class="boxShadow">

const browser = self.browser || self.chrome;
const TARGETS = [
    "https://miyabi381.github.io/Scheduler-test.html",
    "https://x.com/"
];


browser.tabs.onUpdated.addListener((tabId, changeInfo, tab) => {
    if (changeInfo.status !== "complete") return;
    if (!tab.url || !tab.url.startsWith("http")) return;

    if (!TARGETS.some(url => tab.url.startsWith(url))) return;

    browser.scripting.executeScript({
        target: { tabId },
        files: ["common.js", "main.js"]
    });
});

    
						</pre>
				</td>
			</tr>
		</table>
		<table frame="box" class="mokuji">
			<tr>
				<td style="width: 700px;"></td>
			</tr>
			<tr high="20px">
				<td colspan="3">
					<h3 class="nospace">■ common.js</h3>
				</td>
			</tr>
			<tr>
				<td>
					<pre class="boxShadow">
//　ログ出力
function cLog(text) {
	console.log(text);
}

// クリックイベント
function humanClick(target) {
	const events = ['mousedown', 'mouseup', 'click'];
	events.forEach(type =>
		target.dispatchEvent(new MouseEvent(type, {
			bubbles: true, // 子要素まで
			cancelable: true, // デフォルト処理実行可
			view: window // ウィンドウ内で
		}))
	);
}

    
						</pre>
				</td>
			</tr>
		</table>
		<table frame="box" class="mokuji">
			<tr>
				<td style="width: 700px;"></td>
			</tr>
			<tr high="20px">
				<td colspan="3">
					<h3 class="nospace">■ main.js</h3>
				</td>
			</tr>
			<tr>
				<td>
					<pre class="boxShadow">
cLog("NS-Extension : 読み込み完了");

// 一覧表示ボタン
const itiranbtn = document.querySelector("body > div > div:nth-child(4) > button");
humanClick(itiranbtn);
    
						</pre>
				</td>
			</tr>
		</table>




		<footer class="footer">
			<p>&copy;Miyabi. All rights reserved.</p>
		</footer>
	</div>
</body>

</html>